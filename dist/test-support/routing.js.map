{"version":3,"file":"routing.js","sources":["../../src/test-support/routing.ts"],"sourcesContent":["import { assert } from '@ember/debug';\nimport Router from '@ember/routing/router';\n\nimport { properLinks } from '../proper-links.ts';\n\nimport type Owner from '@ember/owner';\nimport type { DSLCallback } from '@ember/routing/lib/dsl';\nimport type RouterService from '@ember/routing/router-service';\n\n/**\n * Allows setting up routes in tests without the need to scaffold routes in the actual app,\n * allowing for iterating on many different routing scenario / configurations rapidly.\n *\n * Example:\n * ```js\n * import { setupRouting } from 'ember-primitives/test-support';\n *\n *  ...\n *\n * test('my test', async function (assert) {\n *   setupRouting(this.owner, function () {\n *     this.route('foo');\n *     this.route('bar', function () {\n *       this.route('a');\n *       this.route('b');\n *     })\n *   });\n *\n *   await visit('/bar/b');\n * });\n * ```\n *\n */\nexport function setupRouting(owner: Owner, map: DSLCallback, options?: { rootURL: string }) {\n  if (options?.rootURL) {\n    assert('rootURL must begin with a forward slash (\"/\")', options?.rootURL?.startsWith('/'));\n  }\n\n  @properLinks\n  class TestRouter extends Router {\n    rootURL = options?.rootURL ?? '/';\n  }\n\n  TestRouter.map(map);\n\n  owner.register('router:main', TestRouter);\n\n  // eslint-disable-next-line ember/no-private-routing-service\n  let iKnowWhatIMDoing = owner.lookup('router:main');\n\n  // We need a public testing API for this sort of stuff\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  (iKnowWhatIMDoing as any).setupRouter();\n}\n\nexport function getRouter(owner: Owner) {\n  return owner.lookup('service:router') as RouterService;\n}\n"],"names":["setupRouting","owner","map","options","rootURL","assert","startsWith","TestRouter","c","Router","properLinks","register","iKnowWhatIMDoing","lookup","setupRouter","getRouter"],"mappings":";;;;;AASA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO,SAASA,YAAYA,CAACC,KAAY,EAAEC,GAAgB,EAAEC,OAA6B,EAAE;EAC1F,IAAIA,OAAO,EAAEC,OAAO,EAAE;IACpBC,MAAM,CAAC,+CAA+C,EAAEF,OAAO,EAAEC,OAAO,EAAEE,UAAU,CAAC,GAAG,CAAC,CAAC,CAAA;AAC5F,GAAA;AAAC,EAAA,MAGKC,UAAU,GAAAC,CAAA,OAAVD,UAAU,SAASE,MAAM,CAAC;AAC9BL,IAAAA,OAAO,GAAGD,OAAO,EAAEC,OAAO,IAAI,GAAG,CAAA;AACnC,GAAC,GAHAM,WAAW,CAAA,CAAA,CAAA;AAKZH,EAAAA,UAAU,CAACL,GAAG,CAACA,GAAG,CAAC,CAAA;AAEnBD,EAAAA,KAAK,CAACU,QAAQ,CAAC,aAAa,EAAEJ,UAAU,CAAC,CAAA;;AAEzC;AACA,EAAA,IAAIK,gBAAgB,GAAGX,KAAK,CAACY,MAAM,CAAC,aAAa,CAAC,CAAA;;AAElD;AACA;EACCD,gBAAgB,CAASE,WAAW,EAAE,CAAA;AACzC,CAAA;AAEO,SAASC,SAASA,CAACd,KAAY,EAAE;AACtC,EAAA,OAAOA,KAAK,CAACY,MAAM,CAAC,gBAAgB,CAAC,CAAA;AACvC;;;;"}